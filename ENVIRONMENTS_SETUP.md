# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Environments –¥–ª—è CI/CD

## üéØ –ß—Ç–æ —Ç–∞–∫–æ–µ GitHub Environments?

GitHub Environments ‚Äî —ç—Ç–æ —Å–ø–æ—Å–æ–± —Å–æ–∑–¥–∞–Ω–∏—è **–∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ä–µ–¥ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è** —Å –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏, —Å–µ–∫—Ä–µ—Ç–∞–º–∏ –∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏ –∑–∞—â–∏—Ç—ã.

## üîß –ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Environments –≤ –≤–∞—à–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

### –®–∞–≥ 1: –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"Settings"** (–ù–∞—Å—Ç—Ä–æ–π–∫–∏)
3. –í –ª–µ–≤–æ–º –º–µ–Ω—é –Ω–∞–π–¥–∏—Ç–µ **"Environments"** (–°—Ä–µ–¥—ã)

### –®–∞–≥ 2: –°–æ–∑–¥–∞–π—Ç–µ Environment "staging"
1. –ù–∞–∂–º–∏—Ç–µ **"New environment"**
2. –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ: `staging`
3. –ù–∞–∂–º–∏—Ç–µ **"Configure environment"**

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è staging:**
- **Protection rules:** –û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º (–¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥—ã)
- **Environment secrets:** –î–æ–±–∞–≤—å—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã (—Å–º. –Ω–∏–∂–µ)
- **Environment variables:** –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (—Å–º. –Ω–∏–∂–µ)

### –®–∞–≥ 3: –°–æ–∑–¥–∞–π—Ç–µ Environment "production"
1. –ù–∞–∂–º–∏—Ç–µ **"New environment"**
2. –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ: `production`
3. –ù–∞–∂–º–∏—Ç–µ **"Configure environment"**

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è production:**
- **Protection rules:** 
  - ‚úÖ **Required reviewers:** –î–æ–±–∞–≤—å—Ç–µ —Å–µ–±—è –∫–∞–∫ —Ä–µ–≤—å—é–µ—Ä–∞
  - ‚úÖ **Wait timer:** 5 –º–∏–Ω—É—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- **Environment secrets:** –î–æ–±–∞–≤—å—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã (—Å–º. –Ω–∏–∂–µ)
- **Environment variables:** –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (—Å–º. –Ω–∏–∂–µ)

## üîê –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–µ–∫—Ä–µ—Ç—ã (Environment Secrets)

### –î–ª—è –æ–±–æ–∏—Ö environments –¥–æ–±–∞–≤—å—Ç–µ:

| –ù–∞–∑–≤–∞–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä –∑–Ω–∞—á–µ–Ω–∏—è |
|------------------|----------|-----------------|
| `POSTGRES_PASSWORD` | –ü–∞—Ä–æ–ª—å –¥–ª—è PostgreSQL | `postgres_passwd_1234` |
| `JWT_SECRET` | –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è JWT —Ç–æ–∫–µ–Ω–æ–≤ | `jwt_scrt_1234` |

### –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã:
1. –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Environment –Ω–∞–∂–º–∏—Ç–µ **"Add secret"**
2. –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–∞
3. –í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–∞
4. –ù–∞–∂–º–∏—Ç–µ **"Add secret"**

## üåç –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (Environment Variables)

### –î–ª—è –æ–±–æ–∏—Ö environments –¥–æ–±–∞–≤—å—Ç–µ:

| –ù–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä –∑–Ω–∞—á–µ–Ω–∏—è |
|---------------------|----------|-----------------|
| `DATABASE_URL` | URL –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î | `postgresql://user:password@postgres-service:5432/scidata` |
| `POSTGRES_DB` | –ù–∞–∑–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö | `scidata` |
| `POSTGRES_USER` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î | `user` |
| `AUTH_SERVICE_URL` | URL —Å–µ—Ä–≤–∏—Å–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ | `http://auth-service:8000` |
| `DATA_SERVICE_URL` | URL —Å–µ—Ä–≤–∏—Å–∞ –¥–∞–Ω–Ω—ã—Ö | `http://data-service:8001` |
| `PROCESSING_SERVICE_URL` | URL —Å–µ—Ä–≤–∏—Å–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ | `http://processing-service:8002` |

### –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
1. –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Environment –Ω–∞–∂–º–∏—Ç–µ **"Add variable"**
2. –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
3. –í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
4. –ù–∞–∂–º–∏—Ç–µ **"Add variable"**

## üöÄ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ CI/CD

### Staging Environment
- **–ö–æ–≥–¥–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:** –ü—Ä–∏ push –≤ –≤–µ—Ç–∫—É `develop`
- **–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:** 
  - –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è `deploy-staging` job
  - –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–µ–∫—Ä–µ—Ç—ã –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ `staging` environment
  - –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ —Ç–µ—Å—Ç–æ–≤—É—é —Å—Ä–µ–¥—É

### Production Environment
- **–ö–æ–≥–¥–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:** –ü—Ä–∏ push –≤ –≤–µ—Ç–∫—É `main`
- **–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
  - –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è `deploy-production` job
  - –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–µ–∫—Ä–µ—Ç—ã –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ `production` environment
  - **–¢—Ä–µ–±—É–µ—Ç—Å—è –æ–¥–æ–±—Ä–µ–Ω–∏–µ —Ä–µ–≤—å—é–µ—Ä–∞** (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)
  - –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ –ø—Ä–æ–¥–∞–∫—à–Ω —Å—Ä–µ–¥—É

## üìã –ü—Ä–∏–º–µ—Ä –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### Staging Environment:
```
–ù–∞–∑–≤–∞–Ω–∏–µ: staging
Protection rules: –ù–µ—Ç
Secrets:
  - POSTGRES_PASSWORD: staging_password_123
  - JWT_SECRET: staging_jwt_secret_456
Variables:
  - DATABASE_URL: postgresql://user:staging_password_123@postgres-service:5432/scidata
  - POSTGRES_DB: scidata
  - POSTGRES_USER: user
```

### Production Environment:
```
–ù–∞–∑–≤–∞–Ω–∏–µ: production
Protection rules:
  - Required reviewers: [–≤–∞—à_username]
  - Wait timer: 5 –º–∏–Ω—É—Ç
Secrets:
  - POSTGRES_PASSWORD: production_secure_password_789
  - JWT_SECRET: production_jwt_secret_012
Variables:
  - DATABASE_URL: postgresql://user:production_secure_password_789@postgres-service:5432/scidata
  - POSTGRES_DB: scidata
  - POSTGRES_USER: user
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ –∫–æ–¥
2. **–†–∞–∑–Ω—ã–µ –ø–∞—Ä–æ–ª–∏:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –¥–ª—è staging –∏ production
3. **–†–µ–≤—å—é–µ—Ä—ã:** –í production –¥–æ–±–∞–≤—å—Ç–µ —Å–µ–±—è –∫–∞–∫ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ —Ä–µ–≤—å—é–µ—Ä–∞
4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ staging, –ø–æ—Ç–æ–º –Ω–∞ production

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ environments:

1. **–°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É `develop`** –∏ —Å–¥–µ–ª–∞–π—Ç–µ push
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ** —á—Ç–æ —Å—Ä–∞–±–æ—Ç–∞–ª `deploy-staging`
3. **–°–æ–∑–¥–∞–π—Ç–µ Pull Request** –∏–∑ `develop` –≤ `main`
4. **–ü–æ—Å–ª–µ –º–µ—Ä–∂–∞** –≤ `main` –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Å—Ä–∞–±–æ—Ç–∞–ª `deploy-production`

–¢–µ–ø–µ—Ä—å –≤–∞—à CI/CD pipeline –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ä–µ–¥—ã! üéâ
